/**
 * Copyright (c) 2013 Aaron Sherrill
 * http://www.digitalsurgeons.com
 * Made with love by Digital Surgeons
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
 function RenderFarm(e){function p(){requestAnimFrame(p);for(r=0;r<t.length;r++){if(t[r].active){l=f-t[r].getMiddle();c=e.height()/2+t[r].getHeight()/2;h=Mathutils.map(l,-c,c,-1,1);t[r].renderAll(h)}}}var t=[];var n=false;var r;var i;var s;var o;var u;var a;var f;var l;var c;var h;e.on("scroll",function(n){u=e.scrollTop();a=u+e.height();f=u+e.height()*.5;for(r=0;r<t.length;r++){if(t[r].getTop()<a&&t[r].getBottom()>u){if(!t[r].active){t[r].activate()}l=f-t[r].getMiddle();c=e.height()/2+t[r].getHeight()/2;h=Mathutils.map(l,-c,c,-1,1);t[r].scrollAll(h)}else{if(t[r].active){t[r].deactivate(t[r].getBottom()>u)}}}});this.addGroup=function(e){t.push(e);e.prepare()};this.start=function(){p();e.trigger("scroll")}}function RenderableContainer(e){var t=e;var n=[];var r=t.height();var i;var s;var o;this.active=false;this.prepare=function(){i=t.position().top;s=i+t.height();o=i+(s-i)*.5;for(var e=0;e<n.length;e++){if(n[e].hasOwnProperty("prepare")){n[e].prepare()}}};this.getTop=function(){return i};this.getBottom=function(){return s};this.getMiddle=function(){return o};this.getHeight=function(){return r};this.activate=function(){this.active=true;t.addClass("active");for(var e=0;e<n.length;e++){if(n[e].hasOwnProperty("focus")){n[e].focus()}}};this.deactivate=function(e){this.active=false;t.removeClass("active");for(var r=0;r<n.length;r++){if(n[r].hasOwnProperty("blur")){n[r].blur(e)}}};this.renderAll=function(e){for(var t=0;t<n.length;t++){if(n[t].hasOwnProperty("render")){n[t].render(e)}}};this.scrollAll=function(e){for(var t=0;t<n.length;t++){if(n[t].hasOwnProperty("scroll")){n[t].scroll(e)}}};this.addChild=function(e){n.push(e);if(e.hasOwnProperty("core")){t.append(e.core())}}}window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();(function(){var e=0;var t=["ms","moz","webkit","o"];for(var n=0;n<t.length&&!window.requestAnimationFrame;++n){window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame)window.requestAnimationFrame=function(t,n){var r=(new Date).getTime();var i=Math.max(0,16-(r-e));var s=window.setTimeout(function(){t(r+i)},i);e=r+i;return s};if(!window.cancelAnimationFrame)window.cancelAnimationFrame=function(e){clearTimeout(e)}})();var Mathutils={normalize:function(e,t,n){return(e-t)/(n-t)},interpolate:function(e,t,n){return t+(n-t)*e},map:function(e,t,n,r,i){if(e<t){e=t}if(e>n){e=n}var s=this.interpolate(this.normalize(e,t,n),r,i);return s}}